<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Robust Backfitting  • RBF</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Robust Backfitting ">
<meta property="og:description" content="A robust backfitting algorithm for additive models based on (robust) local polynomial 
             kernel smoothers. It includes both bounded and re-descending (kernel) M-estimators, and
             it computes predictions for points outside the training set if desired. See
             Boente, Martinez and Salibian-Barrera (2017) &lt;doi:10.1080/10485252.2017.1369077&gt; for
             details. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">RBF</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Examples.html">Examples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<p>Matias Salibian 2021-01-18</p>
<div id="a-robust-backfitting-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#a-robust-backfitting-algorithm" class="anchor"></a>A robust backfitting algorithm</h2>
<p>The <code>R</code> package <code>RBF</code> (available on CRAN <a href="https://cran.r-project.org/package=RBF">here</a>) implements the robust back-fitting algorithm as proposed by Boente, Martinez and Salibian-Barrera in</p>
<blockquote>
<p>Boente G, Martinez A, Salibian-Barrera M. (2017) Robust estimators for additive models using backfitting. Journal of Nonparametric Statistics. Taylor &amp; Francis; 29, 744-767. <a href="https://doi.org/10.1080/10485252.2017.1369077">DOI: 10.1080/10485252.2017.1369077</a></p>
</blockquote>
<p>This repository contains a development version of <code>RBF</code> which may differ slightly from the one available on CRAN (until the CRAN version is updated appropriately).</p>
<p>The package in this repository can be installed from within <code>R</code> by using the following code (assuming the <a href="https://cran.r-project.org/package=devtools">devtools</a>) package is available:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"msalibian/RBF"</span><span class="op">)</span></code></pre></div>
<div id="an-example" class="section level3">
<h3 class="hasAnchor">
<a href="#an-example" class="anchor"></a>An example</h3>
<p>Here is a (longish) example on how <code>RBF</code> works. We use the Air Quality data. The interest is in predicting <code>Ozone</code> in terms of three explanatory variables: <code>Solar.R</code>, <code>Wind</code> and <code>Temp</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RBF</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Ozone'</span>, <span class="st">'Solar.R'</span>, <span class="st">'Wind'</span>, <span class="st">'Temp'</span><span class="op">)</span><span class="op">]</span>, 
      pch<span class="op">=</span><span class="fl">19</span>, col<span class="op">=</span><span class="st">'gray30'</span>, cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></code></pre></div>
<p><img src="README_files/figure-gfm/intro-1.png"><!-- --></p>
<p>The following bandwidths were obtained via a robust leave-one-out cross-validation procedure (described in the paper). As a robust prediction error measure we use <code>mu^2 + sigma^2</code> where <code>mu</code> and <code>sigma</code> are M-estimators of location and scale of the prediction errors, respectively. The code is copied below:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Bandwidth selection with leave-one-out cross-validation</span>
<span class="co">## Without outliers</span>
<span class="co"># This takes a long time to compute (approx 380 minutes running</span>
<span class="co"># R 3.6.1 on an Intel(R) Core(TM) i7-4790 CPU @ 3.60GHz)</span>
<span class="va">ccs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span> <span class="va">airquality</span><span class="op">[</span><span class="va">ccs</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Solar.R'</span>, <span class="st">'Wind'</span>, <span class="st">'Temp'</span><span class="op">)</span><span class="op">]</span> <span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span> <span class="va">airquality</span><span class="op">[</span><span class="va">ccs</span>, <span class="st">'Ozone'</span><span class="op">]</span> <span class="op">)</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">2</span>, <span class="fl">2.5</span>, <span class="fl">3</span><span class="op">)</span>
<span class="va">h1</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="va">h2</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="va">h3</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>
<span class="va">hh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="va">h1</span>, <span class="va">h2</span>, <span class="va">h3</span><span class="op">)</span>
<span class="va">nh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">hh</span><span class="op">)</span>
<span class="va">rmspe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">nh</span><span class="op">)</span>
<span class="va">jbest</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">cvbest</span> <span class="op">&lt;-</span> <span class="op">+</span><span class="cn">Inf</span>
<span class="co"># leave-one-out</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nh</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># leave-one-out CV loop</span>
  <span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n</span><span class="op">)</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span> <span class="fu"><a href="reference/backf.rob.html">backf.rob</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, point <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">j</span>, <span class="op">]</span>,
                          windows <span class="op">=</span> <span class="va">hh</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span>, epsilon <span class="op">=</span> <span class="fl">1e-6</span>,
                          degree <span class="op">=</span> <span class="fl">1</span>, type <span class="op">=</span> <span class="st">'Tukey'</span>, subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">j</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">!=</span> <span class="st">"try-error"</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">preds</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">$</span><span class="va">prediction</span><span class="op">)</span> <span class="op">+</span> <span class="va">tmp</span><span class="op">$</span><span class="va">alpha</span>
    <span class="op">}</span>
  <span class="op">}</span>
  <span class="va">pred.res</span> <span class="op">&lt;-</span> <span class="va">preds</span> <span class="op">-</span> <span class="va">y</span>
  <span class="va">tmp.re</span> <span class="op">&lt;-</span> <span class="fu">RobStatTM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RobStatTM/man/MLocDis.html">locScaleM</a></span><span class="op">(</span><span class="va">pred.res</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">rmspe</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tmp.re</span><span class="op">$</span><span class="va">mu</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">tmp.re</span><span class="op">$</span><span class="va">disper</span><span class="op">^</span><span class="fl">2</span>
  <span class="kw">if</span><span class="op">(</span> <span class="va">rmspe</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">cvbest</span> <span class="op">)</span> <span class="op">{</span>
    <span class="va">jbest</span> <span class="op">&lt;-</span> <span class="va">i</span>
    <span class="va">cvbest</span> <span class="op">&lt;-</span> <span class="va">rmspe</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">'Record'</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">rmspe</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">bandw</span> <span class="op">&lt;-</span> <span class="va">hh</span><span class="op">[</span><span class="va">jbest</span>,<span class="op">]</span></code></pre></div>
<p>Here we just set them to their optimal values:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bandw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">136.7285</span>, <span class="fl">10.67314</span>, <span class="fl">4.764985</span><span class="op">)</span></code></pre></div>
<p>Now we use the robust backfitting algorithm to fit an additive model using Tukey’s bisquare loss (the default tuning constant for this loss function is 4.685). We remove cases with missing entries.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ccs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span>
<span class="va">fit.full</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/backf.rob.html">backf.rob</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="va">Solar.R</span> <span class="op">+</span> <span class="va">Wind</span> <span class="op">+</span> <span class="va">Temp</span>, data<span class="op">=</span><span class="va">airquality</span>,
                subset<span class="op">=</span><span class="va">ccs</span>, windows<span class="op">=</span><span class="va">bandw</span>, degree<span class="op">=</span><span class="fl">1</span>, type<span class="op">=</span><span class="st">'Tukey'</span><span class="op">)</span></code></pre></div>
<p>We display the 3 fits (one per additive component), being careful with the axis limits (which are stored to use them later):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lim.cl</span> <span class="op">&lt;-</span> <span class="va">lim.rob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>
<span class="va">x0</span> <span class="op">&lt;-</span> <span class="va">fit.full</span><span class="op">$</span><span class="va">Xp</span>
<span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">re</span> <span class="op">&lt;-</span> <span class="va">fit.full</span><span class="op">$</span><span class="va">y</span> <span class="op">-</span> <span class="va">fit.full</span><span class="op">$</span><span class="va">alpha</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">fit.full</span><span class="op">$</span><span class="va">g.matrix</span><span class="op">[</span>,<span class="op">-</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="va">lim.rob</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">re</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">re</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">re</span> <span class="op">~</span> <span class="va">x0</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span>, type<span class="op">=</span><span class="st">'p'</span>, pch<span class="op">=</span><span class="fl">19</span>, col<span class="op">=</span><span class="st">'gray30'</span>, 
       xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, ylab<span class="op">=</span><span class="st">''</span>, cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span>
  <span class="va">oo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">x0</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x0</span><span class="op">[</span><span class="va">oo</span>,<span class="va">j</span><span class="op">]</span>, <span class="va">fit.full</span><span class="op">$</span><span class="va">g.matrix</span><span class="op">[</span><span class="va">oo</span>,<span class="va">j</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">5</span>, col<span class="op">=</span><span class="st">'blue'</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="README_files/figure-gfm/showfits-1.png" width="33%"><img src="README_files/figure-gfm/showfits-2.png" width="33%"><img src="README_files/figure-gfm/showfits-3.png" width="33%"></p>
<p>NOTE: These plots could also be obtained using the <code>plot</code> method:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot each component</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">fit.full</span>, which<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p>We now compute and display the classical backfitting fits, with bandwidths chosen via leave-one-out CV:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gam</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="va">aircomplete</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Ozone'</span>, <span class="st">'Solar.R'</span>, <span class="st">'Wind'</span>, <span class="st">'Temp'</span><span class="op">)</span><span class="op">]</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="fl">.4</span>, <span class="fl">.5</span>, <span class="fl">.6</span>, <span class="fl">.7</span>, <span class="fl">.8</span>, <span class="fl">.9</span><span class="op">)</span>
<span class="va">hh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">a</span>, <span class="va">a</span><span class="op">)</span>
<span class="va">nh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">hh</span><span class="op">)</span>
<span class="va">jbest</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">cvbest</span> <span class="op">&lt;-</span> <span class="op">+</span><span class="cn">Inf</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nh</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">fi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/gam.html">gam</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/lo.html">lo</a></span><span class="op">(</span><span class="va">Solar.R</span>, span<span class="op">=</span><span class="va">hh</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/lo.html">lo</a></span><span class="op">(</span><span class="va">Wind</span>, span<span class="op">=</span><span class="va">hh</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>
               <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/lo.html">lo</a></span><span class="op">(</span><span class="va">Temp</span>, span<span class="op">=</span><span class="va">hh</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>, data<span class="op">=</span><span class="va">x</span>, subset<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">j</span><span class="op">)</span><span class="op">)</span>
    <span class="va">fi</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">tmp</span>, newdata<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span>, type<span class="op">=</span><span class="st">'response'</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">Ozone</span> <span class="op">-</span> <span class="va">fi</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">ss</span> <span class="op">&lt;</span> <span class="va">cvbest</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">jbest</span> <span class="op">&lt;-</span> <span class="va">i</span>
    <span class="va">cvbest</span> <span class="op">&lt;-</span> <span class="va">ss</span>
  <span class="op">}</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">ss</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="op">(</span><span class="va">hh</span><span class="op">[</span><span class="va">jbest</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<p>The optimal bandwidths are <code>0.7</code>, <code>0.7</code> and <code>0.5</code> for <code>Solar.R</code>, <code>Wind</code> and <code>Temp</code>, respectively. Below are plots of partial residuals with the classical and robust fits overlaid:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aircomplete</span> <span class="op">&lt;-</span> <span class="va">airquality</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span>, <span class="op">]</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gam</span><span class="op">)</span>
<span class="va">fit.gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/gam.html">gam</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/lo.html">lo</a></span><span class="op">(</span><span class="va">Solar.R</span>, span<span class="op">=</span><span class="fl">.7</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/lo.html">lo</a></span><span class="op">(</span><span class="va">Wind</span>, span<span class="op">=</span><span class="fl">.7</span><span class="op">)</span><span class="op">+</span>
                 <span class="fu"><a href="https://rdrr.io/pkg/gam/man/lo.html">lo</a></span><span class="op">(</span><span class="va">Temp</span>, span<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>, data<span class="op">=</span><span class="va">aircomplete</span><span class="op">)</span>
<span class="co"># Plot both fits (robust and classical) </span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span> <span class="va">aircomplete</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Solar.R'</span>, <span class="st">'Wind'</span>, <span class="st">'Temp'</span><span class="op">)</span><span class="op">]</span> <span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span> <span class="va">aircomplete</span><span class="op">[</span> , <span class="st">'Ozone'</span><span class="op">]</span> <span class="op">)</span>
<span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit.gam</span>, type<span class="op">=</span><span class="st">'terms'</span><span class="op">)</span>
<span class="co"># alpha.gam &lt;- attr(fits, 'constant')</span>
<span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">re</span> <span class="op">&lt;-</span> <span class="va">fit.full</span><span class="op">$</span><span class="va">yp</span> <span class="op">-</span> <span class="va">fit.full</span><span class="op">$</span><span class="va">alpha</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">fit.full</span><span class="op">$</span><span class="va">g.matrix</span><span class="op">[</span>,<span class="op">-</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">re</span> <span class="op">~</span> <span class="va">x</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span>, type<span class="op">=</span><span class="st">'p'</span>, pch<span class="op">=</span><span class="fl">20</span>, col<span class="op">=</span><span class="st">'gray45'</span>, xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, ylab<span class="op">=</span><span class="st">''</span><span class="op">)</span>
  <span class="va">oo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">oo</span>,<span class="va">j</span><span class="op">]</span>, <span class="va">fit.full</span><span class="op">$</span><span class="va">g.matrix</span><span class="op">[</span><span class="va">oo</span>,<span class="va">j</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">5</span>, col<span class="op">=</span><span class="st">'blue'</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">oo</span>,<span class="va">j</span><span class="op">]</span>, <span class="va">fits</span><span class="op">[</span><span class="va">oo</span>,<span class="va">j</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">5</span>, col<span class="op">=</span><span class="st">'magenta'</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="README_files/figure-gfm/classicfits-1.png" width="33%"><img src="README_files/figure-gfm/classicfits-2.png" width="33%"><img src="README_files/figure-gfm/classicfits-3.png" width="33%"></p>
<p>To identify potential outiers we look at the residuals from the robust fit, and use the function <code>boxplot</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">re.ro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">fit.full</span><span class="op">)</span>
<span class="va">ou.ro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">re.ro</span>, col<span class="op">=</span><span class="st">'gray80'</span><span class="op">)</span><span class="op">$</span><span class="va">out</span>
<span class="va">in.ro</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">re.ro</span><span class="op">)</span><span class="op">)</span><span class="op">[</span> <span class="va">re.ro</span> <span class="op">%in%</span> <span class="va">ou.ro</span> <span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">in.ro</span><span class="op">)</span><span class="op">)</span>, <span class="va">re.ro</span><span class="op">[</span><span class="va">in.ro</span><span class="op">]</span>, pch<span class="op">=</span><span class="fl">20</span>, cex<span class="op">=</span><span class="fl">1.5</span>, col<span class="op">=</span><span class="st">'red'</span><span class="op">)</span></code></pre></div>
<p><img src="README_files/figure-gfm/outliers-1.png"><!-- --></p>
<p>We highlight these suspicious observations on the scatter plot</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'gray30'</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">aircomplete</span><span class="op">)</span><span class="op">)</span>
<span class="va">cs</span><span class="op">[</span><span class="va">in.ro</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'red'</span>
<span class="va">os</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">aircomplete</span><span class="op">)</span>
<span class="va">os2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">os</span><span class="op">[</span><span class="op">-</span><span class="va">in.ro</span><span class="op">]</span>, <span class="va">os</span><span class="op">[</span><span class="va">in.ro</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">aircomplete</span><span class="op">[</span><span class="va">os2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Ozone'</span>, <span class="st">'Solar.R'</span>, <span class="st">'Wind'</span>, <span class="st">'Temp'</span><span class="op">)</span><span class="op">]</span>, 
      pch<span class="op">=</span><span class="fl">19</span>, col<span class="op">=</span><span class="va">cs</span><span class="op">[</span><span class="va">os2</span><span class="op">]</span>, cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></code></pre></div>
<p><img src="README_files/figure-gfm/showouts-1.png"><!-- --></p>
<p>and on the partial residuals plots</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">re</span> <span class="op">&lt;-</span> <span class="va">fit.full</span><span class="op">$</span><span class="va">yp</span> <span class="op">-</span> <span class="va">fit.full</span><span class="op">$</span><span class="va">alpha</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">fit.full</span><span class="op">$</span><span class="va">g.matrix</span><span class="op">[</span>,<span class="op">-</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">re</span> <span class="op">~</span> <span class="va">x</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span>, type<span class="op">=</span><span class="st">'p'</span>, pch<span class="op">=</span><span class="fl">20</span>, col<span class="op">=</span><span class="st">'gray45'</span>, xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, ylab<span class="op">=</span><span class="st">''</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">re</span><span class="op">[</span><span class="va">in.ro</span><span class="op">]</span> <span class="op">~</span> <span class="va">x0</span><span class="op">[</span><span class="va">in.ro</span>,<span class="va">j</span><span class="op">]</span>, pch<span class="op">=</span><span class="fl">19</span>, col<span class="op">=</span><span class="st">'red'</span>, cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span>
  <span class="va">oo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">oo</span>,<span class="va">j</span><span class="op">]</span>, <span class="va">fit.full</span><span class="op">$</span><span class="va">g.matrix</span><span class="op">[</span><span class="va">oo</span>,<span class="va">j</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">5</span>, col<span class="op">=</span><span class="st">'blue'</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">oo</span>,<span class="va">j</span><span class="op">]</span>, <span class="va">fits</span><span class="op">[</span><span class="va">oo</span>,<span class="va">j</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">5</span>, col<span class="op">=</span><span class="st">'magenta'</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="README_files/figure-gfm/showouts2-1.png" width="33%"><img src="README_files/figure-gfm/showouts2-2.png" width="33%"><img src="README_files/figure-gfm/showouts2-3.png" width="33%"></p>
<p>We now compute the classical backfitting algorithm on the data without the potential outliers identified by the robust fit (the optimal smoothing parameters for the non-robust fit were re-computed using leave-one-out cross-validation on the “clean” data set). Note that now both fits (robust and non-robust) are<br>
almost identical.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Run the classical backfitting algorithm without outliers</span>
<span class="va">airclean</span> <span class="op">&lt;-</span> <span class="va">aircomplete</span><span class="op">[</span><span class="op">-</span><span class="va">in.ro</span>, <span class="op">]</span>
<span class="va">fit.gam2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/gam.html">gam</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/lo.html">lo</a></span><span class="op">(</span><span class="va">Solar.R</span>, span<span class="op">=</span><span class="fl">.7</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/lo.html">lo</a></span><span class="op">(</span><span class="va">Wind</span>, span<span class="op">=</span><span class="fl">.8</span><span class="op">)</span><span class="op">+</span>
                  <span class="fu"><a href="https://rdrr.io/pkg/gam/man/lo.html">lo</a></span><span class="op">(</span><span class="va">Temp</span>, span<span class="op">=</span><span class="fl">.3</span><span class="op">)</span>, data<span class="op">=</span><span class="va">airclean</span><span class="op">)</span>
<span class="va">fits2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit.gam2</span>, type<span class="op">=</span><span class="st">'terms'</span><span class="op">)</span>
<span class="co"># alpha.gam2 &lt;- attr(fits2, 'constant')</span>
<span class="va">dd2</span> <span class="op">&lt;-</span> <span class="va">aircomplete</span><span class="op">[</span><span class="op">-</span><span class="va">in.ro</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Solar.R'</span>, <span class="st">'Wind'</span>, <span class="st">'Temp'</span><span class="op">)</span><span class="op">]</span>
<span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">re</span> <span class="op">&lt;-</span> <span class="va">fit.full</span><span class="op">$</span><span class="va">yp</span> <span class="op">-</span> <span class="va">fit.full</span><span class="op">$</span><span class="va">alpha</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">fit.full</span><span class="op">$</span><span class="va">g.matrix</span><span class="op">[</span>,<span class="op">-</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">re</span> <span class="op">~</span> <span class="va">x</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span>, type<span class="op">=</span><span class="st">'p'</span>, pch<span class="op">=</span><span class="fl">20</span>, col<span class="op">=</span><span class="st">'gray45'</span>, xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, ylab<span class="op">=</span><span class="st">''</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">re</span><span class="op">[</span><span class="va">in.ro</span><span class="op">]</span> <span class="op">~</span> <span class="va">x</span><span class="op">[</span><span class="va">in.ro</span>,<span class="va">j</span><span class="op">]</span>, pch<span class="op">=</span><span class="fl">20</span>, col<span class="op">=</span><span class="st">'red'</span>, cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span>
  <span class="va">oo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">dd2</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">dd2</span><span class="op">[</span><span class="va">oo</span>,<span class="va">j</span><span class="op">]</span>, <span class="va">fits2</span><span class="op">[</span><span class="va">oo</span>,<span class="va">j</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">5</span>, col<span class="op">=</span><span class="st">'magenta'</span><span class="op">)</span>
  <span class="va">oo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">oo</span>,<span class="va">j</span><span class="op">]</span>, <span class="va">fit.full</span><span class="op">$</span><span class="va">g.matrix</span><span class="op">[</span><span class="va">oo</span>,<span class="va">j</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">5</span>, col<span class="op">=</span><span class="st">'blue'</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="README_files/figure-gfm/bothonclean-1.png" width="33%"><img src="README_files/figure-gfm/bothonclean-2.png" width="33%"><img src="README_files/figure-gfm/bothonclean-3.png" width="33%"></p>
<p>Finally, we compare the prediction accuracy obtained with each of the fits. Because we are not interested in predicting well any possible outliers in the data, we evaluate the quality of the predictions using a 5%-trimmed mean squared prediction error (effectively measuring the prediction accuracy on 95% of the data). We use this alpha-trimmed mean squared function:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tms</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">alpha</span><span class="op">=</span><span class="fl">.1</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># alpha is the proportion to trim</span>
  <span class="va">a2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">a</span><span class="op">^</span><span class="fl">2</span>, na.last<span class="op">=</span><span class="cn">NA</span><span class="op">)</span>
  <span class="va">n0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">)</span> <span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">a2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n0</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>We use 100 runs of 5-fold CV to compare the 5%-trimmed mean squared prediction error of the robust fit and the classical one. Note that the bandwidths are kept fixed at their optimal value estimated above.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dd</span> <span class="op">&lt;-</span> <span class="va">airquality</span>
<span class="va">dd</span> <span class="op">&lt;-</span> <span class="va">dd</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">dd</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Ozone'</span>, <span class="st">'Solar.R'</span>, <span class="st">'Wind'</span>, <span class="st">'Temp'</span><span class="op">)</span><span class="op">]</span>
<span class="co"># 100 runs of K-fold CV</span>
<span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="co"># 5-fold</span>
<span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">5</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dd</span><span class="op">)</span>
<span class="co"># store (trimmed) TMSPE for robust and gam, and also</span>
<span class="va">tmspe.ro</span> <span class="op">&lt;-</span> <span class="va">tmspe.gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">'numeric'</span>, <span class="va">M</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">ii</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">%%</span><span class="va">K</span> <span class="op">+</span> <span class="fl">1</span>
<span class="kw">for</span><span class="op">(</span><span class="va">runs</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">M</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmpro</span> <span class="op">&lt;-</span> <span class="va">tmpgam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">'numeric'</span>, <span class="va">n</span><span class="op">)</span>
  <span class="va">ii</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">ii</span><span class="op">)</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">K</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">fit.full</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/backf.rob.html">backf.rob</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="va">Solar.R</span> <span class="op">+</span> <span class="va">Wind</span> <span class="op">+</span> <span class="va">Temp</span>, 
                           point<span class="op">=</span><span class="va">dd</span><span class="op">[</span><span class="va">ii</span><span class="op">==</span><span class="va">j</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, windows<span class="op">=</span><span class="va">bandw</span>, 
                           epsilon<span class="op">=</span><span class="fl">1e-6</span>, degree<span class="op">=</span><span class="fl">1</span>, type<span class="op">=</span><span class="st">'Tukey'</span>, 
                           subset <span class="op">=</span> <span class="op">(</span><span class="va">ii</span><span class="op">!=</span><span class="va">j</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dd</span><span class="op">)</span>
    <span class="va">tmpro</span><span class="op">[</span> <span class="va">ii</span> <span class="op">==</span> <span class="va">j</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">fit.full</span><span class="op">$</span><span class="va">prediction</span><span class="op">)</span> <span class="op">+</span> <span class="va">fit.full</span><span class="op">$</span><span class="va">alpha</span>
    <span class="va">fit.gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/gam.html">gam</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/lo.html">lo</a></span><span class="op">(</span><span class="va">Solar.R</span>, span<span class="op">=</span><span class="fl">.7</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/lo.html">lo</a></span><span class="op">(</span><span class="va">Wind</span>, span<span class="op">=</span><span class="fl">.7</span><span class="op">)</span><span class="op">+</span>
                     <span class="fu"><a href="https://rdrr.io/pkg/gam/man/lo.html">lo</a></span><span class="op">(</span><span class="va">Temp</span>, span<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>, data<span class="op">=</span><span class="va">dd</span><span class="op">[</span><span class="va">ii</span><span class="op">!=</span><span class="va">j</span>, <span class="op">]</span><span class="op">)</span>
    <span class="va">tmpgam</span><span class="op">[</span> <span class="va">ii</span> <span class="op">==</span> <span class="va">j</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit.gam</span>, newdata<span class="op">=</span><span class="va">dd</span><span class="op">[</span><span class="va">ii</span><span class="op">==</span><span class="va">j</span>, <span class="op">]</span>, type<span class="op">=</span><span class="st">'response'</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">tmspe.ro</span><span class="op">[</span><span class="va">runs</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">tms</span><span class="op">(</span> <span class="va">dd</span><span class="op">$</span><span class="va">Ozone</span> <span class="op">-</span> <span class="va">tmpro</span>, alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span>
  <span class="va">tmspe.gam</span><span class="op">[</span><span class="va">runs</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">tms</span><span class="op">(</span> <span class="va">dd</span><span class="op">$</span><span class="va">Ozone</span> <span class="op">-</span> <span class="va">tmpgam</span>, alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>These are the boxplots. We see that the robust fit consistently fits the vast majority (95%) of the data better than the classical one.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">tmspe.ro</span>, <span class="va">tmspe.gam</span>, names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Robust'</span>, <span class="st">'Classical'</span><span class="op">)</span>, 
        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'tomato3'</span>, <span class="st">'gray80'</span><span class="op">)</span><span class="op">)</span> <span class="co">#, main='', ylim=c(130, 210))</span></code></pre></div>
<p><img src="README_files/figure-gfm/pred3-1.png"><!-- --></p>
<p>As a sanity check, we compare the prediction accuracy of the robust and non-robust fits using only the “clean” data set. We re-compute the optimal bandwidths for the robust fit using leave-one-out cross validation as above, and as above, note that these bandwidths are kept fixed. We use 100 runs of 5-fold cross-validation, and compute both the trimmed and the regular mean squared prediction errors of each fit.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aq</span> <span class="op">&lt;-</span> <span class="va">airquality</span>
<span class="va">aq2</span> <span class="op">&lt;-</span> <span class="va">aq</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">aq</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Ozone'</span>, <span class="st">'Solar.R'</span>, <span class="st">'Wind'</span>, <span class="st">'Temp'</span><span class="op">)</span><span class="op">]</span>
<span class="va">airclean</span> <span class="op">&lt;-</span> <span class="va">aq2</span><span class="op">[</span> <span class="op">-</span><span class="va">in.ro</span>, <span class="op">]</span>
<span class="va">bandw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">138.2699</span>, <span class="fl">10.46753</span>, <span class="fl">4.828436</span><span class="op">)</span>
<span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">100</span> 
<span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">5</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">airclean</span><span class="op">)</span>
<span class="va">mspe.ro</span> <span class="op">&lt;-</span> <span class="va">mspe.gam</span> <span class="op">&lt;-</span> <span class="va">tmspe.ro</span> <span class="op">&lt;-</span> <span class="va">tmspe.gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">'numeric'</span>, <span class="va">M</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">17</span><span class="op">)</span>
<span class="va">ii</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">%%</span><span class="va">K</span> <span class="op">+</span> <span class="fl">1</span>
<span class="kw">for</span><span class="op">(</span><span class="va">runs</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">M</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmpro</span> <span class="op">&lt;-</span> <span class="va">tmpgam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">'numeric'</span>, <span class="va">n</span><span class="op">)</span>
  <span class="va">ii</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">ii</span><span class="op">)</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">K</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">fit.full</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span> <span class="fu"><a href="reference/backf.rob.html">backf.rob</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="va">Solar.R</span> <span class="op">+</span> <span class="va">Wind</span> <span class="op">+</span> <span class="va">Temp</span>, 
                          point<span class="op">=</span><span class="va">airclean</span><span class="op">[</span><span class="va">ii</span><span class="op">==</span><span class="va">j</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, windows<span class="op">=</span><span class="va">bandw</span>, 
                          epsilon<span class="op">=</span><span class="fl">1e-6</span>, degree<span class="op">=</span><span class="fl">1</span>, type<span class="op">=</span><span class="st">'Tukey'</span>, 
                          subset <span class="op">=</span> <span class="op">(</span><span class="va">ii</span><span class="op">!=</span><span class="va">j</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">airclean</span><span class="op">)</span> <span class="op">)</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">fit.full</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">!=</span> <span class="st">"try-error"</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">tmpro</span><span class="op">[</span> <span class="va">ii</span> <span class="op">==</span> <span class="va">j</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">fit.full</span><span class="op">$</span><span class="va">prediction</span><span class="op">)</span> <span class="op">+</span> <span class="va">fit.full</span><span class="op">$</span><span class="va">alpha</span>
    <span class="op">}</span>
    <span class="va">fit.gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/gam.html">gam</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/lo.html">lo</a></span><span class="op">(</span><span class="va">Solar.R</span>, span<span class="op">=</span><span class="fl">.7</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/gam/man/lo.html">lo</a></span><span class="op">(</span><span class="va">Wind</span>, span<span class="op">=</span><span class="fl">.8</span><span class="op">)</span><span class="op">+</span>
                     <span class="fu"><a href="https://rdrr.io/pkg/gam/man/lo.html">lo</a></span><span class="op">(</span><span class="va">Temp</span>, span<span class="op">=</span><span class="fl">.3</span><span class="op">)</span>, data<span class="op">=</span><span class="va">airclean</span>, subset <span class="op">=</span> <span class="op">(</span><span class="va">ii</span><span class="op">!=</span><span class="va">j</span><span class="op">)</span> <span class="op">)</span>
    <span class="va">tmpgam</span><span class="op">[</span> <span class="va">ii</span> <span class="op">==</span> <span class="va">j</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit.gam</span>, newdata<span class="op">=</span><span class="va">airclean</span><span class="op">[</span><span class="va">ii</span><span class="op">==</span><span class="va">j</span>, <span class="op">]</span>, 
                                 type<span class="op">=</span><span class="st">'response'</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">tmspe.ro</span><span class="op">[</span><span class="va">runs</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">tms</span><span class="op">(</span> <span class="va">airclean</span><span class="op">$</span><span class="va">Ozone</span> <span class="op">-</span> <span class="va">tmpro</span>, alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span>
  <span class="va">mspe.ro</span><span class="op">[</span><span class="va">runs</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span> <span class="op">(</span> <span class="va">airclean</span><span class="op">$</span><span class="va">Ozone</span> <span class="op">-</span> <span class="va">tmpro</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">tmspe.gam</span><span class="op">[</span><span class="va">runs</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">tms</span><span class="op">(</span> <span class="va">airclean</span><span class="op">$</span><span class="va">Ozone</span> <span class="op">-</span> <span class="va">tmpgam</span>, alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span>
  <span class="va">mspe.gam</span><span class="op">[</span><span class="va">runs</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span> <span class="op">(</span> <span class="va">airclean</span><span class="op">$</span><span class="va">Ozone</span> <span class="op">-</span> <span class="va">tmpgam</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>The boxplots of the trimmed and regular mean squared prediction errors over the 100 cross-validation runs are below. We see that for the majority of the runs both estimators provide very similar prediction errors. Note that we naturally expect a robust method to perform slightly worse than the classical one when no model deviations occur. The boxplots below show that for this robust backfitting estimator, this loss in prediction accuracy is in fact very small.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">tmspe.ro</span>, <span class="va">tmspe.gam</span>, names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Robust'</span>, <span class="st">'Classical'</span><span class="op">)</span>, 
        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'tomato3'</span>, <span class="st">'gray80'</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, main<span class="op">=</span><span class="st">'Trimmed MSPE On "clean" data'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">mspe.ro</span>, <span class="va">mspe.gam</span>, names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Robust'</span>, <span class="st">'Classical'</span><span class="op">)</span>, 
        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'tomato3'</span>, <span class="st">'gray80'</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, main<span class="op">=</span><span class="st">'Non-Trimmed MSPE On "clean" data'</span><span class="op">)</span></code></pre></div>
<p><img src="README_files/figure-gfm/boxplot.clean.predictions-1.png" width="33%"><img src="README_files/figure-gfm/boxplot.clean.predictions-2.png" width="33%"></p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=RBF">https://​cloud.r-project.org/​package=RBF</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;=3.0)</small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Matias Salibian-Barrera <br><small class="roles"> Author, maintainer </small>  </li>
<li>Alejandra Martinez <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Matias Salibian-Barrera, Alejandra Martinez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
